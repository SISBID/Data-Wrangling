---
title: "Data Reshaping Lab Key"
author: "Data Wrangling in R"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

1.  Read in the Circulator Data from http://sisbid.github.io/Data-Wrangling/data/Charm_City_Circulator_Ridership.csv.  Name the data set `wide`.

```{r, message = FALSE}
wide <- read_csv("http://sisbid.github.io/Data-Wrangling/data/Charm_City_Circulator_Ridership.csv")
```

2. Reshape to long format using `pivot_longer`. Call this data `long.`  Make the `names_to = `
`name`, and the values `n_people`  Make sure we gather all columns **but**
`daily`, `day`, `date`, using the `!`.

```{r}
long <- wide %>% 
  pivot_longer( !c(daily, day, date), names_to = "name", values_to = "n_people")
head(long)
```

3.  Separate the `date` column into ("month", "day", "year") using `separate()` and `sep = "/"`.
Make sure you don't remove the `date` column, call this `long2`.  Do a table of the day column.  Where did the original `day` column go?

```{r}
# We over-wrote the day column by assigning it new values (in this case, calendar "day")
long2 <- long %>%
  separate(col = "date", into = c("month", "day", "year"),
           sep = "/", remove = FALSE)
table(long2$day)
```

4. Run the following to recreate what we covered in lecture:

```{r, error = TRUE}
long3 <- long %>%
  mutate(
    name = str_replace(name, "Board", "_Board"),
    name = str_replace(name, "Alight", "_Alight"),
    name = str_replace(name, "Average", "_Average")
  ) %>%
  separate(name, into = c("route", "type"), sep = "_")

```

5. Reshape `long3` using `pivot_wider()`.  Spread the data out so the `route` becomes the new column names and the cells are filled with the `n_people` value.  Call this `wide_by_route`.

```{r}
wide_by_route <- long3 %>% 
  pivot_wider(names_from = route, values_from = n_people)
```

5. Reshape `long3` using `pivot_wider()`.  Spread the data out so the `day` becomes the new column names and the cells are filled with the `n_people` value.  Call this `wide_by_day`.

```{r}
wide_by_day <- long3 %>% 
  pivot_wider(names_from = day, values_from = n_people)
```
